import{w as D}from"./chunk-XJI4KG32-C1vvKahF.js";const F=t=>{let o;const e=new Set,n=(u,v)=>{const h=typeof u=="function"?u(o):u;if(!Object.is(h,o)){const y=o;o=v??(typeof h!="object"||h===null)?h:Object.assign({},o,h),e.forEach(p=>p(o,y))}},r=()=>o,l={setState:n,getState:r,getInitialState:()=>g,subscribe:u=>(e.add(u),()=>e.delete(u))},g=o=t(n,r,l);return l},E=t=>t?F(t):F,H=t=>t;function L(t,o=H){const e=D.useSyncExternalStore(t.subscribe,()=>o(t.getState()),()=>o(t.getInitialState()));return D.useDebugValue(e),e}const j=t=>{const o=E(t),e=n=>L(o,n);return Object.assign(e,o),e},N=t=>j;function O(t,o){let e;try{e=t()}catch{return}return{getItem:r=>{var s;const c=g=>g===null?null:JSON.parse(g,void 0),l=(s=e.getItem(r))!=null?s:null;return l instanceof Promise?l.then(c):c(l)},setItem:(r,s)=>e.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>e.removeItem(r)}}const w=t=>o=>{try{const e=t(o);return e instanceof Promise?e:{then(n){return w(n)(e)},catch(n){return this}}}catch(e){return{then(n){return this},catch(n){return w(n)(e)}}}},J=(t,o)=>(e,n,r)=>{let s={storage:O(()=>localStorage),partialize:a=>a,version:0,merge:(a,S)=>({...S,...a}),...o},c=!1;const l=new Set,g=new Set;let u=s.storage;if(!u)return t((...a)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),e(...a)},n,r);const v=()=>{const a=s.partialize({...n()});return u.setItem(s.name,{state:a,version:s.version})},h=r.setState;r.setState=(a,S)=>{h(a,S),v()};const y=t((...a)=>{e(...a),v()},n,r);r.getInitialState=()=>y;let p;const U=()=>{var a,S;if(!u)return;c=!1,l.forEach(d=>{var m;return d((m=n())!=null?m:y)});const f=((S=s.onRehydrateStorage)==null?void 0:S.call(s,(a=n())!=null?a:y))||void 0;return w(u.getItem.bind(u))(s.name).then(d=>{if(d)if(typeof d.version=="number"&&d.version!==s.version){if(s.migrate){const m=s.migrate(d.state,d.version);return m instanceof Promise?m.then(b=>[!0,b]):[!0,m]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,d.state];return[!1,void 0]}).then(d=>{var m;const[b,G]=d;if(p=s.merge(G,(m=n())!=null?m:y),e(p,!0),b)return v()}).then(()=>{f==null||f(p,void 0),p=n(),c=!0,g.forEach(d=>d(p))}).catch(d=>{f==null||f(void 0,d)})};return r.persist={setOptions:a=>{s={...s,...a},a.storage&&(u=a.storage)},clearStorage:()=>{u==null||u.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>U(),hasHydrated:()=>c,onHydrate:a=>(l.add(a),()=>{l.delete(a)}),onFinishHydration:a=>(g.add(a),()=>{g.delete(a)})},s.skipHydration||U(),p||y},A=J,i=[];for(let t=0;t<256;++t)i.push((t+256).toString(16).slice(1));function M(t,o=0){return(i[t[o+0]]+i[t[o+1]]+i[t[o+2]]+i[t[o+3]]+"-"+i[t[o+4]]+i[t[o+5]]+"-"+i[t[o+6]]+i[t[o+7]]+"-"+i[t[o+8]]+i[t[o+9]]+"-"+i[t[o+10]]+i[t[o+11]]+i[t[o+12]]+i[t[o+13]]+i[t[o+14]]+i[t[o+15]]).toLowerCase()}let I;const P=new Uint8Array(16);function T(){if(!I){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");I=crypto.getRandomValues.bind(crypto)}return I(P)}const k=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),R={randomUUID:k};function B(t,o,e){var r;if(R.randomUUID&&!t)return R.randomUUID();t=t||{};const n=t.random??((r=t.rng)==null?void 0:r.call(t))??T();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,M(n)}const C=["No Group","Friends","Family"],$=[{user:"roei",password:"123",role:"admin"},{user:"user",password:"123",role:"user"}];function _(){return[{name:"Alice Johnson",phone:"555-123-4567",id:"1"},{name:"Bob Martinez",phone:"555-987-6543",id:"2"},{name:"Carla Nguyen",phone:"555-246-8101",id:"3"},{name:"David Smith",phone:"555-369-1212",id:"4"}].map(o=>({...o,group:C[Math.floor(Math.random()*3)]}))}const x=N()(A((t,o)=>({addToFavorites:e=>t(n=>({contacts:n.contacts.map(r=>r.id==e?{...r,isFavorite:!0}:r)})),removeFromFavorites:e=>t(n=>({contacts:n.contacts.map(r=>r.id==e?{...r,isFavorite:!1}:r)})),addGroup:e=>t(n=>({groups:Array.from(new Set([...n.groups,e]))})),deleteGroup:e=>t(n=>{const r=n.groups.findIndex(c=>c==e);if(r==-1)return{};const s=n.contacts.filter(c=>c.group!=e);return{groups:n.groups.toSpliced(r,1),contacts:s}}),setGroups:e=>t(n=>({groups:[...e]})),groups:[...C],role:"user",loggedIn:!1,username:"",login:(e,n)=>t(r=>{const s=$.find(c=>c.user.toLocaleLowerCase()==e.toLocaleLowerCase()&&c.password==n);if(!s)throw new Error("bad username");return{role:s.role,username:s.user,loggedIn:!0}}),setContacts:e=>t(n=>({contacts:e})),contacts:[..._()],addContact:e=>t(n=>{const r={...e,id:B()};return r.group=r.group||"No Group",{contacts:[...n.contacts,r]}}),editContact:(e,n)=>t(r=>{const s=r.contacts.findIndex(l=>l.id==e);if(s==-1)return{};const c=[...r.contacts];return c[s]={...n,id:e},{contacts:c}}),removeContact:e=>t(n=>{const r=n.contacts.findIndex(s=>s.id==e);return r==-1?{}:{contacts:n.contacts.toSpliced(r,1)}})}),{name:"store"}));function K(){x.getState().setContacts(_()),x.getState().setGroups([...C])}export{C as m,K as r,x as u};
